---
description: sherpa-onnx STT integration reference
globs: "**/speech/**,**/stt/**,**/audio/**"
---

# sherpa-onnx Integration

- Android AAR from Maven or GitHub releases (v1.12.13+)
- Use a transducer model that supports hotword biasing (chosen by user — NOT Moonshine)
- Silero VAD bundled — handles speech start/end
- Add 300ms silence padding before/after detected speech segments
- Trailing silence endpointing: 200-250ms
- Hotword biasing: feed card names + slang as hotwords (boost 5.0-6.0)
- Accuracy strategy: hotword biasing + alias dictionary + deck-scoped fuzzy matching (8 candidates) + post-correction rules
- STT confidence: check if the chosen transducer model provides it. If not, gate on parser similarity (Levenshtein score).
- Kotlin API package: com.k2fsa.sherpa.onnx
- Reference: github.com/k2-fsa/sherpa-onnx/tree/master/android
- Fallback: Android SpeechRecognizer API if sherpa-onnx fails after 2 hours
